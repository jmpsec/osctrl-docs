[
{
	"uri": "https://osctrl.net/usage/osctrl-cli/audit-logs/",
	"title": "audit-logs",
	"tags": [],
	"description": "",
	"content": "Audit Logs $ ./bin/osctrl-cli audit-logs -h NAME: osctrl-cli audit-logs - Get all audit logs for actions performed in osctrl USAGE: osctrl-cli audit-logs [command options] OPTIONS: --help, -h Show help (default: false) This command retrieves all audit logs for actions performed in osctrl.\n"
},
{
	"uri": "https://osctrl.net/usage/osctrld/",
	"title": "osctrld",
	"tags": [],
	"description": "",
	"content": "osctrld is the daemon service for enrolled osquery nodes in osctrl.\nExecute ./osctrld -h to show the main help of the program:\n$ ./bin/osctrld -h NAME: osctrld - Daemon for osctrl, the fast and efficient osquery management USAGE: osctrld [global options] command [command options] [arguments...] VERSION: 1.0.0 DESCRIPTION: Daemon for osctrl, the fast and efficient osquery management, to manage secret, flags and osquery deployment COMMANDS: enroll Enroll a new node in osctrl, using new secret and flag files remove Remove enrolled node from osctrl, clearing secret and flag files verify Verify flags, cert and secret for an enrolled node in osctrl flags Retrieve flags for osquery from osctrl and write them locally cert Retrieve server certificate for osquery from osctrl and write it locally help, h Shows a list of commands or help for one command GLOBAL OPTIONS: --certificate FILE, -C FILE Use FILE as certificate for osquery, if needed. Default depends on OS [$OSQUERY_CERTIFICATE] --configuration value, -c value, --conf value, --config value Configuration file for osctrld to load all necessary values [$OSCTRL_CONFIG] --environment value, -e value, --env value Environment in osctrl to enrolled nodes to [$OSCTRL_ENV] --flagfile FILE, -F FILE Use FILE as flagfile for osquery. Default depends on OS [$OSQUERY_FLAGFILE] --force, -f Overwrite existing files for flags, certificate and secret (default: false) [$OSCTRL_FORCE] --help, -h show help (default: false) --insecure, -i Ignore TLS warnings, often used with self-signed certificates (default: false) [$OSCTRL_INSECURE] --osctrl-url value, -U value Base URL for the osctrl server [$OSCTRL_URL] --osquery-path FILE, --osquery FILE, -o FILE Use FILE as path for osquery installation, if needed. Default depends on OS [$OSQUERY_PATH] --secret value, -s value Enroll secret to authenticate against osctrl server [$OSCTRL_SECRET] --secret-file FILE, -S FILE Use FILE as secret file for osquery. Default depends on OS [$OSQUERY_SECRET] --verbose, -V Enable verbose informational messages (default: false) [$OSCTRL_VERBOSE] --version, -v print the version (default: false) "
},
{
	"uri": "https://osctrl.net/usage/osctrl-tls/",
	"title": "osctrl-tls",
	"tags": [],
	"description": "",
	"content": "osctrl-tls is the TLS service for osctrl.\nExecute ./osctrl-tls help to show the main help of the program:\n$ ./osctrl-tls help NAME: osctrl-tls - TLS service for osctrl, a fast and efficient osquery management USAGE: osctrl-tls [global options] [command [command options]] DESCRIPTION: TLS service for osctrl, a fast and efficient osquery management COMMANDS: help config-validate, config-verify Validate YAML configuration file config-generate Generate an example configuration file using the current flag values GLOBAL OPTIONS: --config, -c Provide service configuration via YAML file [$SERVICE_CONFIG] --config-file FILE, -C FILE Load service configuration from FILE (default: \u0026#34;./config/tls.yml\u0026#34;) [$SERVICE_CONFIG_FILE] --listener string, -l string Listener for the service (default: \u0026#34;127.0.0.1\u0026#34;) [$SERVICE_LISTENER] --port int, -p int TCP port for the service (default: 9000) [$SERVICE_PORT] --host string, -H string Exposed hostname the service uses (default: \u0026#34;osctrl.net\u0026#34;) [$SERVICE_HOST] --auth string, -A string Authentication mechanism for the service (default: \u0026#34;none\u0026#34;) [$SERVICE_AUTH] --log-level string Log level for the service (default: \u0026#34;info\u0026#34;) [$SERVICE_LOG_LEVEL] --log-format string Log format for the service (default: \u0026#34;json\u0026#34;) [$SERVICE_LOG_FORMAT] --audit-log, --audit Enable audit log for the service. Logs all sensitive actions [$AUDIT_LOG] --logger string, -L string Logger mechanism to handle status/result logs from nodes (default: \u0026#34;db\u0026#34;) [$SERVICE_LOGGER] --logger-db-same Use the same DB configuration for the logger [$LOGGER_DB_SAME] --always-log, -a, --always Always log status and on-demand query logs from nodes in database [$ALWAYS_LOG] --metrics-listener string Listener for prometheus metrics (default: \u0026#34;127.0.0.1\u0026#34;) [$METRICS_LISTENER] --metrics-port int Port for exposing prometheus metrics (default: 9090) [$METRICS_PORT] --metrics-enabled Enable prometheus metrics [$METRICS_ENABLED] --writer-batch-size int Maximum number of events before flushing (default: 50) [$WRITER_BATCH_SIZE] --writer-timeout duration Maximum wait time before flushing (default: 1m0s) [$WRITER_TIMEOUT] --writer-buffer-size int Size of the event channel buffer (default: 2000) [$WRITER_BUFFER_SIZE] --redis-connection-string string Redis connection string, must include schema (\u0026lt;redis|rediss|unix\u0026gt;://\u0026lt;user\u0026gt;:\u0026lt;pass\u0026gt;@\u0026lt;host\u0026gt;:\u0026lt;port\u0026gt;/\u0026lt;db\u0026gt;?\u0026lt;options\u0026gt; [$REDIS_CONNECTION_STRING] --redis-host string Redis host to be connected to (default: \u0026#34;127.0.0.1\u0026#34;) [$REDIS_HOST] --redis-port int Redis port to be connected to (default: 6379) [$REDIS_PORT] --redis-pass string Password to be used for redis [$REDIS_PASS] --redis-db int Redis database to be selected after connecting (default: 0) [$REDIS_DB] --redis-conn-retry int Time in seconds to retry the connection to the cache, if set to 0 the service will stop if the connection fails (default: 10) [$REDIS_CONN_RETRY] --db-type string Type of backend to be used (default: \u0026#34;postgres\u0026#34;) [$DB_TYPE] --db-host string Backend host to be connected to (default: \u0026#34;127.0.0.1\u0026#34;) [$DB_HOST] --db-port int Backend port to be connected to (default: 5432) [$DB_PORT] --db-name string Database name to be used in the backend (default: \u0026#34;osctrl\u0026#34;) [$DB_NAME] --db-user string Username to be used for the backend (default: \u0026#34;postgres\u0026#34;) [$DB_USER] --db-pass string Password to be used for the backend (default: \u0026#34;postgres\u0026#34;) [$DB_PASS] --db-sslmode string SSL native support to encrypt the connection to the backend (default: \u0026#34;disable\u0026#34;) [$DB_SSLMODE] --db-max-idle-conns int Maximum number of connections in the idle connection pool (default: 20) [$DB_MAX_IDLE_CONNS] --db-max-open-conns int Maximum number of open connections to the database (default: 100) [$DB_MAX_OPEN_CONNS] --db-conn-max-lifetime int Maximum amount of time a connection may be reused (default: 30) [$DB_CONN_MAX_LIFETIME] --db-conn-retry int Time in seconds to retry the connection to the database, if set to 0 the service will stop if the connection fails (default: 10) [$DB_CONN_RETRY] --db-filepath string File path to the SQLite database, only used when type is sqlite (default: \u0026#34;./osctrl.db\u0026#34;) [$DB_SQLITE_FILEPATH] --tls, -t Enable TLS termination. It requires certificate and key [$TLS_SERVER] --cert FILE, -T FILE TLS termination certificate from FILE (default: \u0026#34;./config/tls.crt\u0026#34;) [$TLS_CERTIFICATE] --key FILE, -K FILE TLS termination private key from FILE (default: \u0026#34;./config/tls.key\u0026#34;) [$TLS_KEY] --enable-osctrld Enable osctrld endpoints and functionality. [$OSCTRLD] --osquery-version string Version of osquery to be used (default: \u0026#34;5.20.0\u0026#34;) [$OSQUERY_VERSION] --osquery-tables-file string File with the osquery tables to be used (default: \u0026#34;./data/5.20.0.json\u0026#34;) [$OSQUERY_TABLES] --osquery-logger Enable remote tls logger for osquery [$OSQUERY_LOGGER] --osquery-config Enable remote tls config for osquery [$OSQUERY_CONFIG] --osquery-query Enable remote tls queries for osquery [$OSQUERY_QUERY] --osquery-carve Enable remote tls carver for osquery [$OSQUERY_CARVE] --carver-type string Carver to be used to receive files extracted from nodes (default: \u0026#34;db\u0026#34;) [$CARVER_TYPE] --carver-s3-bucket string S3 bucket to be used as configuration for carves [$CARVER_S3_BUCKET] --carver-s3-region string S3 region to be used as configuration for carves [$CARVER_S3_REGION] --carve-s3-key-id string S3 access key id to be used as configuration for carves [$CARVER_S3_KEY_ID] --carve-s3-secret string S3 access key secret to be used as configuration for carves [$CARVER_S3_SECRET] --carver-local-dir string Local directory to store carved files (default: \u0026#34;./carved_files/\u0026#34;) [$CARVER_LOCAL_DIR] --log-s3-bucket string S3 bucket to be used as configuration for logging [$LOG_S3_BUCKET] --log-s3-region string S3 region to be used as configuration for logging [$LOG_S3_REGION] --log-s3-key-id string S3 access key id to be used as configuration for logging [$LOG_S3_KEY_ID] --log-s3-secret string S3 access key secret to be used as configuration for logging [$LOG_S3_SECRET] --log-kafka-boostrap-servers string Kafka bootstrap servers to be used as configuration for logging [$LOG_KAFKA_BOOTSTRAP_SERVERS] --log-kafka-sslca-location string Kafka sslca location to be used as configuration for logging [$LOG_KAFKA_SSLCA_LOCATION] --log-kafka-connection-timeout duration Kafka connection timeout to be used as configuration for logging (default: 5s) [$LOG_KAFKA_CONNECTION_TIMEOUT] --log-kafka-topic string Kafka topic to be used as configuration for logging [$LOG_KAFKA_TOPIC] --log-kafka-sasl-mechanism string Kafka sasl mechanism\u0026#39; to be used as configuration for logging [$LOG_KAFKA_SASL_MECHANISM] --log-kafka-sasl-username string Kafka sasl username\u0026#39; to be used as configuration for logging [$LOG_KAFKA_SASL_USERNAME] --log-kafka-sasl-password string Kafka sasl password\u0026#39; to be used as configuration for logging [$LOG_KAFKA_SASL_PASSWORD] --enable-http-debug Enable HTTP Debug mode to dump full HTTP incoming request [$HTTP_DEBUG] --http-debug-file string File to dump the HTTP requests when HTTP Debug mode is enabled (default: \u0026#34;./debug-http-tls.log\u0026#34;) [$HTTP_DEBUG_FILE] --http-debug-show-body Show body of the HTTP requests when HTTP Debug mode is enabled [$HTTP_DEBUG_SHOW_BODY] --version, -v Print version information --help, -h show help "
},
{
	"uri": "https://osctrl.net/components/osctrl-tls/",
	"title": "osctrl-tls",
	"tags": [],
	"description": "",
	"content": " The osctrl-tls component is the actual TLS endpoint that implements the remote API of osquery.\nInside of the osctrl-tls, you can run a number of TLS endpoints, to group the nodes that will enroll in each of them. Within osctrl this concept is called an environment.\nEach environment implements handlers to manage the following actions:\nEnroll nodes, Serve osquery configuration to enrolled nodes, Log osquery status messages and osquery results from enrolled nodes, Run on-demand queries in enrolled nodes and collect results, Perform file carving operations in enrolled nodes. Inside osctrl there can be many environments, like a typical environment where you have corporate and production systems. Then you would have one environment for corp, and another one for prod. The reasoning is, if you may need to distribute different configurations to the enrolled nodes, then you should use different environments.\nEnrolling osquery nodes As mentioned before, osquery nodes must be enrolled inside of an environment. In order to achieve that, osquery requires an enrolling secret that will be stored in disk. Also, and given that osquery communicates with osctrl using TLS, a certificate may also be needed.\nFor example, here are the flags to enroll osquery nodes in the dev environment, used as example when deploying osctrl locally. The important part are the path for the different requests to arrive and the intervals in secods:\n--host_identifier=uuid --force=true --utc=true --enroll_secret_path=__SECRET_FILE__ --enroll_tls_endpoint=/dev/enroll --config_plugin=tls --config_tls_endpoint=/dev/config --config_tls_refresh=300 --config_tls_max_attempts=5 --logger_plugin=tls --logger_tls_compress=true --logger_tls_endpoint=/dev/log --logger_tls_period=600 --disable_carver=false --carver_disable_function=false --carver_start_endpoint=/dev/init --carver_continue_endpoint=/dev/block --disable_distributed=false --distributed_interval=60 --distributed_plugin=tls --distributed_tls_max_attempts=3 --distributed_tls_read_endpoint=/dev/read --distributed_tls_write_endpoint=/dev/write --tls_dump=true --tls_hostname=osctrl-nginx --tls_server_certs=__CERT_FILE__ The values of __CERT_FILE__ and __SECRET_FILE__ will be the local full path for certificate and secret respectively.\nEscaling osctrl-tls The idea behind making osctrl-tls its own component is all about scalability. In a scenario with many nodes enrolled, the number of requests is going to increase quickly, especially if we lower the intervals.\nRunning multiple instances of osctrl-tls will help to scale the service and be reliable for a larger number of nodes.\nFor example, using the intervals of the flags above, where logs, configuration and queries run every 600, 300 and 60 seconds. Presuming that you have 1000 machines and you want to enroll them all in osctrl\n"
},
{
	"uri": "https://osctrl.net/components/",
	"title": "Components",
	"tags": [],
	"description": "",
	"content": "Components Diagram of all the osctrl components in action\n"
},
{
	"uri": "https://osctrl.net/usage/osctrl-cli/carve/",
	"title": "carve",
	"tags": [],
	"description": "",
	"content": "Carve $ ./osctrl-cli carve -h NAME: osctrl-cli carve - Commands for file carves USAGE: osctrl-cli carve command [command options] [arguments...] COMMANDS: complete, c Mark an file carve query as completed delete, d Mark a file carve query as deleted expire, e Mark a file carve query as expired run, r Start a new carve for a file or a directory list, l List file carves list-queries, l List file carves queries help, h Shows a list of commands or help for one command OPTIONS: --help, -h show help Complete carve $ ./osctrl-cli carve complete -h NAME: osctrl-cli carve complete - Mark an file carve query as completed USAGE: osctrl-cli carve complete [command options] [arguments...] OPTIONS: --name value, -n value Carve name to be completed --env value, -e value Environment to be used --help, -h show help Delete carve $ ./osctrl-cli carve delete -h NAME: osctrl-cli carve delete - Mark a file carve query as deleted USAGE: osctrl-cli carve delete [command options] [arguments...] OPTIONS: --name value, -n value Carve name to be deleted --env value, -e value Environment to be used --help, -h show help Expire carve $ ./osctrl-cli carve expire -h NAME: osctrl-cli carve expire - Mark a file carve query as expired USAGE: osctrl-cli carve expire [command options] [arguments...] OPTIONS: --name value, -n value Carve name to be expired --env value, -e value Environment to be used --help, -h show help Run carve $ ./osctrl-cli carve run -h NAME: osctrl-cli carve run - Start a new carve for a file or a directory USAGE: osctrl-cli carve run [command options] [arguments...] OPTIONS: --path value, -p value File or directory path to be carved --env value, -e value Environment to be used --uuid value, -u value Node UUID to be used --expiration value, -E value Expiration in hours (0 for no expiration) (default: 6) --help, -h show help List carves $ ./osctrl-cli carve list -h NAME: osctrl-cli carve list - List file carves USAGE: osctrl-cli carve list [command options] [arguments...] OPTIONS: --env value, -e value Environment to be used --help, -h show help List carve queries $ ./osctrl-cli carve list-queries -h NAME: osctrl-cli carve list-queries - List file carves queries USAGE: osctrl-cli carve list-queries [command options] [arguments...] OPTIONS: --all, -A Show all file carves queries (default: false) --active, -a Show active file carves queries (default: false) --completed, -c Show completed file carves queries (default: false) --expired, -E Show expired file carves queries (default: false) --deleted, -d Show deleted file carves queries (default: false) --env value, -e value Environment to be used --help, -h show help "
},
{
	"uri": "https://osctrl.net/usage/osctrl-api/",
	"title": "osctrl-api",
	"tags": [],
	"description": "",
	"content": "osctrl-api is the API service for osctrl.\nExecute ./osctrl-api help to show the main help of the program:\n$ ./osctrl-api help NAME: osctrl-api - API service for osctrl, a fast and efficient osquery management USAGE: osctrl-api [global options] [command [command options]] DESCRIPTION: API service for osctrl, a fast and efficient osquery management COMMANDS: help config-validate, config-verify Validate YAML configuration file config-generate Generate an example configuration file using the current flag values GLOBAL OPTIONS: --config, -c Provide service configuration via YAML file [$SERVICE_CONFIG] --config-file FILE, -C FILE Load service configuration from FILE (default: \u0026#34;./config/api.yml\u0026#34;) [$SERVICE_CONFIG_FILE] --listener string, -l string Listener for the service (default: \u0026#34;127.0.0.1\u0026#34;) [$SERVICE_LISTENER] --port int, -p int TCP port for the service (default: 9000) [$SERVICE_PORT] --host string, -H string Exposed hostname the service uses (default: \u0026#34;osctrl.net\u0026#34;) [$SERVICE_HOST] --auth string, -A string Authentication mechanism for the service (default: \u0026#34;none\u0026#34;) [$SERVICE_AUTH] --log-level string Log level for the service (default: \u0026#34;info\u0026#34;) [$SERVICE_LOG_LEVEL] --log-format string Log format for the service (default: \u0026#34;json\u0026#34;) [$SERVICE_LOG_FORMAT] --audit-log, --audit Enable audit log for the service. Logs all sensitive actions [$AUDIT_LOG] --logger string, -L string Logger mechanism to handle status/result logs from nodes (default: \u0026#34;db\u0026#34;) [$SERVICE_LOGGER] --logger-db-same Use the same DB configuration for the logger [$LOGGER_DB_SAME] --always-log, -a, --always Always log status and on-demand query logs from nodes in database [$ALWAYS_LOG] --redis-connection-string string Redis connection string, must include schema (\u0026lt;redis|rediss|unix\u0026gt;://\u0026lt;user\u0026gt;:\u0026lt;pass\u0026gt;@\u0026lt;host\u0026gt;:\u0026lt;port\u0026gt;/\u0026lt;db\u0026gt;?\u0026lt;options\u0026gt; [$REDIS_CONNECTION_STRING] --redis-host string Redis host to be connected to (default: \u0026#34;127.0.0.1\u0026#34;) [$REDIS_HOST] --redis-port int Redis port to be connected to (default: 6379) [$REDIS_PORT] --redis-pass string Password to be used for redis [$REDIS_PASS] --redis-db int Redis database to be selected after connecting (default: 0) [$REDIS_DB] --redis-conn-retry int Time in seconds to retry the connection to the cache, if set to 0 the service will stop if the connection fails (default: 10) [$REDIS_CONN_RETRY] --db-type string Type of backend to be used (default: \u0026#34;postgres\u0026#34;) [$DB_TYPE] --db-host string Backend host to be connected to (default: \u0026#34;127.0.0.1\u0026#34;) [$DB_HOST] --db-port int Backend port to be connected to (default: 5432) [$DB_PORT] --db-name string Database name to be used in the backend (default: \u0026#34;osctrl\u0026#34;) [$DB_NAME] --db-user string Username to be used for the backend (default: \u0026#34;postgres\u0026#34;) [$DB_USER] --db-pass string Password to be used for the backend (default: \u0026#34;postgres\u0026#34;) [$DB_PASS] --db-sslmode string SSL native support to encrypt the connection to the backend (default: \u0026#34;disable\u0026#34;) [$DB_SSLMODE] --db-max-idle-conns int Maximum number of connections in the idle connection pool (default: 20) [$DB_MAX_IDLE_CONNS] --db-max-open-conns int Maximum number of open connections to the database (default: 100) [$DB_MAX_OPEN_CONNS] --db-conn-max-lifetime int Maximum amount of time a connection may be reused (default: 30) [$DB_CONN_MAX_LIFETIME] --db-conn-retry int Time in seconds to retry the connection to the database, if set to 0 the service will stop if the connection fails (default: 10) [$DB_CONN_RETRY] --db-filepath string File path to the SQLite database, only used when type is sqlite (default: \u0026#34;./osctrl.db\u0026#34;) [$DB_SQLITE_FILEPATH] --tls, -t Enable TLS termination. It requires certificate and key [$TLS_SERVER] --cert FILE, -T FILE TLS termination certificate from FILE (default: \u0026#34;./config/tls.crt\u0026#34;) [$TLS_CERTIFICATE] --key FILE, -K FILE TLS termination private key from FILE (default: \u0026#34;./config/tls.key\u0026#34;) [$TLS_KEY] --jwt-secret string Password to be used for the backend [$JWT_SECRET] --jwt-expire int Maximum amount of hours for the tokens to expire (default: 3) [$JWT_EXPIRE] --osquery-version string Version of osquery to be used (default: \u0026#34;5.20.0\u0026#34;) [$OSQUERY_VERSION] --osquery-tables-file string File with the osquery tables to be used (default: \u0026#34;./data/5.20.0.json\u0026#34;) [$OSQUERY_TABLES] --osquery-logger Enable remote tls logger for osquery [$OSQUERY_LOGGER] --osquery-config Enable remote tls config for osquery [$OSQUERY_CONFIG] --osquery-query Enable remote tls queries for osquery [$OSQUERY_QUERY] --osquery-carve Enable remote tls carver for osquery [$OSQUERY_CARVE] --carver-type string Carver to be used to receive files extracted from nodes (default: \u0026#34;db\u0026#34;) [$CARVER_TYPE] --carver-s3-bucket string S3 bucket to be used as configuration for carves [$CARVER_S3_BUCKET] --carver-s3-region string S3 region to be used as configuration for carves [$CARVER_S3_REGION] --carve-s3-key-id string S3 access key id to be used as configuration for carves [$CARVER_S3_KEY_ID] --carve-s3-secret string S3 access key secret to be used as configuration for carves [$CARVER_S3_SECRET] --carver-local-dir string Local directory to store carved files (default: \u0026#34;./carved_files/\u0026#34;) [$CARVER_LOCAL_DIR] --enable-http-debug Enable HTTP Debug mode to dump full HTTP incoming request [$HTTP_DEBUG] --http-debug-file string File to dump the HTTP requests when HTTP Debug mode is enabled (default: \u0026#34;./debug-http-api.log\u0026#34;) [$HTTP_DEBUG_FILE] --http-debug-show-body Show body of the HTTP requests when HTTP Debug mode is enabled [$HTTP_DEBUG_SHOW_BODY] --version, -v Print version information --help, -h show help "
},
{
	"uri": "https://osctrl.net/components/osctrl-api/",
	"title": "osctrl-api",
	"tags": [],
	"description": "",
	"content": " The osctrl-api component of osctrl provides an API interface to interact with its enrolled nodes and with osctrl itself.\nYou can find the updated API documentation for osctrl, generated using stoplight.io.\n"
},
{
	"uri": "https://osctrl.net/usage/osctrl-admin/",
	"title": "osctrl-admin",
	"tags": [],
	"description": "",
	"content": "osctrl-admin is the Admin service for osctrl.\nExecute ./osctrl-admin help to show the main help of the program:\n$ ./osctrl-admin help NAME: osctrl-admin - Admin service for osctrl, a fast and efficient osquery management USAGE: osctrl-admin [global options] [command [command options]] DESCRIPTION: Admin service for osctrl, a fast and efficient osquery management COMMANDS: help config-validate, config-verify Validate YAML configuration file config-generate Generate an example configuration file using the current flag values GLOBAL OPTIONS: --config, -c Provide service configuration via YAML file [$SERVICE_CONFIG] --config-file FILE, -C FILE Load service configuration from FILE (default: \u0026#34;./config/admin.yml\u0026#34;) [$SERVICE_CONFIG_FILE] --listener string, -l string Listener for the service (default: \u0026#34;127.0.0.1\u0026#34;) [$SERVICE_LISTENER] --port int, -p int TCP port for the service (default: 9000) [$SERVICE_PORT] --host string, -H string Exposed hostname the service uses (default: \u0026#34;osctrl.net\u0026#34;) [$SERVICE_HOST] --auth string, -A string Authentication mechanism for the service (default: \u0026#34;none\u0026#34;) [$SERVICE_AUTH] --log-level string Log level for the service (default: \u0026#34;info\u0026#34;) [$SERVICE_LOG_LEVEL] --log-format string Log format for the service (default: \u0026#34;json\u0026#34;) [$SERVICE_LOG_FORMAT] --audit-log, --audit Enable audit log for the service. Logs all sensitive actions [$AUDIT_LOG] --logger string, -L string Logger mechanism to handle status/result logs from nodes (default: \u0026#34;db\u0026#34;) [$SERVICE_LOGGER] --logger-db-same Use the same DB configuration for the logger [$LOGGER_DB_SAME] --always-log, -a, --always Always log status and on-demand query logs from nodes in database [$ALWAYS_LOG] --redis-connection-string string Redis connection string, must include schema (\u0026lt;redis|rediss|unix\u0026gt;://\u0026lt;user\u0026gt;:\u0026lt;pass\u0026gt;@\u0026lt;host\u0026gt;:\u0026lt;port\u0026gt;/\u0026lt;db\u0026gt;?\u0026lt;options\u0026gt; [$REDIS_CONNECTION_STRING] --redis-host string Redis host to be connected to (default: \u0026#34;127.0.0.1\u0026#34;) [$REDIS_HOST] --redis-port int Redis port to be connected to (default: 6379) [$REDIS_PORT] --redis-pass string Password to be used for redis [$REDIS_PASS] --redis-db int Redis database to be selected after connecting (default: 0) [$REDIS_DB] --redis-conn-retry int Time in seconds to retry the connection to the cache, if set to 0 the service will stop if the connection fails (default: 10) [$REDIS_CONN_RETRY] --db-type string Type of backend to be used (default: \u0026#34;postgres\u0026#34;) [$DB_TYPE] --db-host string Backend host to be connected to (default: \u0026#34;127.0.0.1\u0026#34;) [$DB_HOST] --db-port int Backend port to be connected to (default: 5432) [$DB_PORT] --db-name string Database name to be used in the backend (default: \u0026#34;osctrl\u0026#34;) [$DB_NAME] --db-user string Username to be used for the backend (default: \u0026#34;postgres\u0026#34;) [$DB_USER] --db-pass string Password to be used for the backend (default: \u0026#34;postgres\u0026#34;) [$DB_PASS] --db-sslmode string SSL native support to encrypt the connection to the backend (default: \u0026#34;disable\u0026#34;) [$DB_SSLMODE] --db-max-idle-conns int Maximum number of connections in the idle connection pool (default: 20) [$DB_MAX_IDLE_CONNS] --db-max-open-conns int Maximum number of open connections to the database (default: 100) [$DB_MAX_OPEN_CONNS] --db-conn-max-lifetime int Maximum amount of time a connection may be reused (default: 30) [$DB_CONN_MAX_LIFETIME] --db-conn-retry int Time in seconds to retry the connection to the database, if set to 0 the service will stop if the connection fails (default: 10) [$DB_CONN_RETRY] --db-filepath string File path to the SQLite database, only used when type is sqlite (default: \u0026#34;./osctrl.db\u0026#34;) [$DB_SQLITE_FILEPATH] --tls, -t Enable TLS termination. It requires certificate and key [$TLS_SERVER] --cert FILE, -T FILE TLS termination certificate from FILE (default: \u0026#34;./config/tls.crt\u0026#34;) [$TLS_CERTIFICATE] --key FILE, -K FILE TLS termination private key from FILE (default: \u0026#34;./config/tls.key\u0026#34;) [$TLS_KEY] --enable-osctrld Enable osctrld endpoints and functionality. [$OSCTRLD] --carver-type string Carver to be used to receive files extracted from nodes (default: \u0026#34;db\u0026#34;) [$CARVER_TYPE] --carver-s3-bucket string S3 bucket to be used as configuration for carves [$CARVER_S3_BUCKET] --carver-s3-region string S3 region to be used as configuration for carves [$CARVER_S3_REGION] --carve-s3-key-id string S3 access key id to be used as configuration for carves [$CARVER_S3_KEY_ID] --carve-s3-secret string S3 access key secret to be used as configuration for carves [$CARVER_S3_SECRET] --carver-local-dir string Local directory to store carved files (default: \u0026#34;./carved_files/\u0026#34;) [$CARVER_LOCAL_DIR] --log-s3-bucket string S3 bucket to be used as configuration for logging [$LOG_S3_BUCKET] --log-s3-region string S3 region to be used as configuration for logging [$LOG_S3_REGION] --log-s3-key-id string S3 access key id to be used as configuration for logging [$LOG_S3_KEY_ID] --log-s3-secret string S3 access key secret to be used as configuration for logging [$LOG_S3_SECRET] --jwt-secret string Password to be used for the backend [$JWT_SECRET] --jwt-expire int Maximum amount of hours for the tokens to expire (default: 3) [$JWT_EXPIRE] --osquery-version string Version of osquery to be used (default: \u0026#34;5.20.0\u0026#34;) [$OSQUERY_VERSION] --osquery-tables-file string File with the osquery tables to be used (default: \u0026#34;./data/5.20.0.json\u0026#34;) [$OSQUERY_TABLES] --osquery-logger Enable remote tls logger for osquery [$OSQUERY_LOGGER] --osquery-config Enable remote tls config for osquery [$OSQUERY_CONFIG] --osquery-query Enable remote tls queries for osquery [$OSQUERY_QUERY] --osquery-carve Enable remote tls carver for osquery [$OSQUERY_CARVE] --session-key string Session key to generate cookies from it [$SESSION_KEY] --static string, -s string Directory with all the static files needed for the osctrl-admin UI (default: \u0026#34;./static\u0026#34;) [$STATIC_FILES] --static-offline, -S Use offline static files (js and css). Default is online files. [$STATIC_ONLINE] --templates string Directory with all the templates needed for the osctrl-admin UI (default: \u0026#34;./tmpl_admin\u0026#34;) [$TEMPLATES_DIR] --background-image string, --bg-img string, --background string Background image file for all the pages in the osctrl-admin UI (default: \u0026#34;./static/img/circuit.svg\u0026#34;) [$BACKGROUND_IMAGE] --branding-image string, --brand-img string, --branding string Branding image file for the osctrl-admin UI. Use an image with 450x130 pixels for best results. (default: \u0026#34;./static/img/brand.png\u0026#34;) [$BRANDING_IMAGE] --enable-http-debug Enable HTTP Debug mode to dump full HTTP incoming request [$HTTP_DEBUG] --http-debug-file string File to dump the HTTP requests when HTTP Debug mode is enabled (default: \u0026#34;./debug-http-admin.log\u0026#34;) [$HTTP_DEBUG_FILE] --http-debug-show-body Show body of the HTTP requests when HTTP Debug mode is enabled [$HTTP_DEBUG_SHOW_BODY] --version, -v Print version information --help, -h show help "
},
{
	"uri": "https://osctrl.net/deployment/docker/",
	"title": "Using Docker",
	"tags": [],
	"description": "",
	"content": "You can use docker to run osctrl and all the components are defined in the docker-compose-dev.yml that ties all the components together, to serve a functional deployment.\nUltimately you can just execute make docker_dev and it will automagically build and run osctrl locally in docker, for development purposes.\n"
},
{
	"uri": "https://osctrl.net/components/osctrl-admin/",
	"title": "osctrl-admin",
	"tags": [],
	"description": "",
	"content": " The osctrl-admin component of osctrl provides an administration interface to interact with the enrolled nodes.\n"
},
{
	"uri": "https://osctrl.net/deployment/",
	"title": "Deployment",
	"tags": [],
	"description": "",
	"content": "Deployment Different ways to deploy osctrl and customize the environment.\n"
},
{
	"uri": "https://osctrl.net/usage/osctrl-cli/check-api/",
	"title": "check-api",
	"tags": [],
	"description": "",
	"content": "Check API $ ./bin/osctrl-cli check-api -h NAME: osctrl-cli check-api - Checks API token USAGE: osctrl-cli check-api [command options] OPTIONS: --help, -h Show help (default: false) Although this command may appear a bit confusing, it comes in really handy to verify when the osctrl-api component is ready to go and the validity of a token.\n"
},
{
	"uri": "https://osctrl.net/usage/osctrl-cli/",
	"title": "osctrl-cli",
	"tags": [],
	"description": "",
	"content": "osctrl-cli is the CLI for osctrl. Its purpose is to execute actions in osctrl without having to access directly the backend or use the admin interface. It can be very handy to automate actions in scripts or similar.\nExecute ./osctrl-cli help to show the main help of the program:\n$ ./osctrl-cli help NAME: osctrl-cli - CLI for osctrl USAGE: osctrl-cli [global options] [command [command options]] DESCRIPTION: CLI for osctrl, a fast and efficient osquery management COMMANDS: audit-logs Get all audit logs for actions performed in osctrl carve Commands for file carves check-api Checks API token check-db Checks DB connection environment, env Commands for TLS environment login Login into API and generate JSON config file with token node Commands for nodes query Commands for queries settings Commands for settings tag Commands for tags user Commands for users help, h Shows a list of commands or help for one command GLOBAL OPTIONS: --db, -d Connect to local osctrl DB using YAML config file [$DB_CONFIG] --api, -a Connect to remote osctrl using JSON config file [$API_CONFIG] --api-file FILE, -A FILE Load API JSON configuration from FILE (default: \u0026#34;osctrl-api.json\u0026#34;) [$API_CONFIG_FILE] --api-url string, -U string The URL for osctrl API to be used [$API_URL] --api-token string, -T string Token to authenticate with the osctrl API [$API_TOKEN] --db-file FILE, -D FILE Load DB YAML configuration from FILE [$DB_CONFIG_FILE] --db-host string Backend host to be connected to (default: \u0026#34;127.0.0.1\u0026#34;) [$DB_HOST] --db-port int Backend port to be connected to (default: 5432) [$DB_PORT] --db-name string Database name to be used in the backend (default: \u0026#34;osctrl\u0026#34;) [$DB_NAME] --db-user string Username to be used for the backend (default: \u0026#34;postgres\u0026#34;) [$DB_USER] --db-pass string Password to be used for the backend (default: \u0026#34;postgres\u0026#34;) [$DB_PASS] --db-max-idle-conns int Maximum number of connections in the idle connection pool (default: 20) [$DB_MAX_IDLE_CONNS] --db-max-open-conns int Maximum number of open connections to the database (default: 100) [$DB_MAX_OPEN_CONNS] --db-conn-max-lifetime int Maximum amount of time a connection may be reused (default: 30) [$DB_CONN_MAX_LIFETIME] --insecure, -i Allow insecure server connections when using SSL --verbose, -V Increase output verbosity for debugging --output-format string, -o string Format to be used for data output (default: \u0026#34;pretty\u0026#34;) [$OUTPUT_FORMAT] --silent, -s Silent mode --version, -v Print version information --help, -h show help Each command has its own help and it is displayed appending -h to them. Each subcommand has its own help as well.\n"
},
{
	"uri": "https://osctrl.net/deployment/natively/",
	"title": "Using provision.sh",
	"tags": [],
	"description": "",
	"content": "If you want to deploy osctrl in your own environment, you can use the provision.sh script to install all necessary dependencies and to configure all components.\nIt is a good idea to take a look at the usage of the provisioning script to understand all the options and all the parameters.\nExamples A very common use case for provisioning osctrl , would run in dev mode and using self-signed certificates. This is would be the preferred choice for development purposes:\n./deploy/provision.sh -m dev -s /path/to/code --nginx --postgres --redis -p all --all-hostname \u0026#34;dev.osctrl.net\u0026#34; -E "
},
{
	"uri": "https://osctrl.net/components/osctrl-cli/",
	"title": "osctrl-cli",
	"tags": [],
	"description": "",
	"content": " The osctrl-cli component is the CLI for osctrl. Its purpose is to execute actions in osctrl without having to access directly the backend or use the admin interface. It can be very handy to automate actions in scripts or similar.\nFor a comprehensive list of all the commands and options, take a look at the usage of osctrl-cli.\nHere is a quick example of what the output of some commands look like:\n"
},
{
	"uri": "https://osctrl.net/configuration/",
	"title": "Configuration",
	"tags": [],
	"description": "",
	"content": "Each component of osctrl requires configuration in order to operate properly. As of PR #754, osctrl uses a single YAML configuration file per service, consolidating all settings into one place.\nBREAKING CHANGE: The previous JSON-based configuration system with multiple separate files (service.json, db.json, redis.json, jwt.json, saml.json, etc.) has been replaced with a single YAML file per service. If you are upgrading from an older version, you will need to migrate your configuration to the new YAML format.\nSingle YAML Configuration All osctrl services (osctrl-tls, osctrl-admin, osctrl-api) now use a unified YAML configuration file that includes all necessary settings in one place. The default filenames are:\ntls.yaml for osctrl-tls admin.yaml for osctrl-admin api.yaml for osctrl-api You can specify a different configuration file using the --config-file or -C flag.\nGenerating and Validating Configuration Each osctrl binary includes built-in commands to help you create and validate configuration files:\nGenerate Configuration To generate a valid YAML configuration file with default values:\n./osctrl-tls config-generate ./osctrl-admin config-generate ./osctrl-api config-generate This will output a complete configuration template to stdout with all available options and their default values. You can redirect this output to create your configuration file:\n./osctrl-tls config-generate \u0026gt; tls.yaml ./osctrl-admin config-generate \u0026gt; admin.yaml ./osctrl-api config-generate \u0026gt; api.yaml The generated configuration includes:\nAll required configuration sections Default values for each setting Comments explaining each field Service-specific options relevant to each binary Verify Configuration To validate an existing configuration file before starting the service:\n./osctrl-tls config-verify --config-file tls.yaml ./osctrl-admin config-verify --config-file admin.yaml ./osctrl-api config-verify --config-file api.yaml The verification process checks:\nYAML syntax validity Required fields are present Configuration values are within valid ranges Authentication method compatibility Logger and carver type validity Database and Redis connection parameters If the configuration is valid, the command will exit with status code 0. If there are errors, detailed error messages will be displayed indicating what needs to be fixed.\nIt\u0026rsquo;s recommended to run config-verify on your configuration files before deploying to production to catch configuration errors early.\nConfiguration Structure The YAML configuration file contains the following main sections:\nService Configuration Basic service settings including network listener, ports, authentication, and logging:\nservice: listener: \u0026#34;0.0.0.0\u0026#34; # Network interface to bind to port: \u0026#34;9000\u0026#34; # TCP port for the service host: \u0026#34;tls.example.com\u0026#34; # Public hostname auth: \u0026#34;none\u0026#34; # Authentication method logLevel: \u0026#34;info\u0026#34; # Logging level: debug, info, warn, error logFormat: \u0026#34;json\u0026#34; # Log format: json, console auditLog: false # Enable audit logging for sensitive actions Authentication types (auth):\nnone - No authentication db - Users stored and retrieved from backend database saml - SAML-based authentication headers - Header-based authentication (middleware approach) jwt - JWT token-based authentication Database Configuration Backend database connection settings:\ndb: type: \u0026#34;postgres\u0026#34; # Database type: postgres, mysql, sqlite host: \u0026#34;127.0.0.1\u0026#34; port: \u0026#34;5432\u0026#34; name: \u0026#34;osctrl\u0026#34; username: \u0026#34;postgres\u0026#34; password: \u0026#34;postgres\u0026#34; sslmode: \u0026#34;disable\u0026#34; # SSL mode for database connection maxIdleConns: 20 # Maximum idle connections maxOpenConns: 100 # Maximum open connections connMaxLifetime: 30 # Connection max lifetime (minutes) connRetry: 5 # Connection retry timeout (seconds, 0=no retry) filePath: \u0026#34;./osctrl.db\u0026#34; # For SQLite only Redis Configuration Cache configuration for session management and performance:\nredis: host: \u0026#34;127.0.0.1\u0026#34; port: \u0026#34;6379\u0026#34; password: \u0026#34;\u0026#34; db: 0 connectionString: \u0026#34;\u0026#34; # Optional: full connection string connRetry: 5 # Connection retry timeout (seconds) Logger Configuration Logging destination and settings:\nlogger: type: \u0026#34;db\u0026#34; # Logger type: db, splunk, graylog, s3, file, kinesis, kafka, logstash, elastic loggerDBSame: true # Use same DB config as main DB for logging alwaysLog: false # Always log to DB regardless of other loggers # Database logger settings (if type: db and loggerDBSame: false) db: type: \u0026#34;postgres\u0026#34; host: \u0026#34;127.0.0.1\u0026#34; # ... (same structure as main db config) # S3 logger settings (if type: s3) s3: bucket: \u0026#34;osctrl-logs\u0026#34; region: \u0026#34;us-east-1\u0026#34; accessKey: \u0026#34;your-access-key\u0026#34; secretAccessKey: \u0026#34;your-secret-key\u0026#34; # Splunk logger settings (if type: splunk) splunk: url: \u0026#34;https://splunk.example.com:8088/services/collector\u0026#34; token: \u0026#34;your-hec-token\u0026#34; host: \u0026#34;osctrl\u0026#34; index: \u0026#34;osquery\u0026#34; # Graylog logger settings (if type: graylog) graylog: url: \u0026#34;http://graylog.example.com:12201/gelf\u0026#34; host: \u0026#34;osctrl\u0026#34; queries: \u0026#34;osquery_queries\u0026#34; status: \u0026#34;osquery_status\u0026#34; results: \u0026#34;osquery_results\u0026#34; # File logger settings (if type: file) local: filePath: \u0026#34;/var/log/osctrl/osctrl.log\u0026#34; maxSize: 25 # Max file size in MB before rotation maxBackups: 5 # Number of old log files to retain maxAge: 10 # Max days to retain old log files compress: true # Compress rotated files with gzip Logger types:\ndb - Store logs in the backend database splunk - Send logs to Splunk HEC graylog - Send logs to Graylog GELF endpoint s3 - Upload logs to AWS S3 file - Write logs to local file with rotation kinesis - Send logs to AWS Kinesis kafka - Send logs to Kafka topics logstash - Send logs to Logstash elastic - Send logs directly to Elasticsearch Carver Configuration File carving storage settings:\ncarver: type: \u0026#34;db\u0026#34; # Carver type: db, s3, local # S3 carver settings (if type: s3) s3: bucket: \u0026#34;osctrl-carves\u0026#34; region: \u0026#34;us-east-1\u0026#34; accessKey: \u0026#34;your-access-key\u0026#34; secretAccessKey: \u0026#34;your-secret-key\u0026#34; # Local carver settings (if type: local) local: carvesDir: \u0026#34;/var/osctrl/carves\u0026#34; # Directory to store carved files Carver types:\ndb - Store carved files in the database s3 - Upload carved files to AWS S3 local - Store carved files in local directory TLS Configuration TLS termination settings:\ntls: termination: true # Enable TLS termination certificateFile: \u0026#34;/path/to/cert.pem\u0026#34; keyFile: \u0026#34;/path/to/key.pem\u0026#34; Osquery Configuration Osquery-specific settings for TLS service:\nosquery: version: \u0026#34;5.12.1\u0026#34; # Osquery version tablesFile: \u0026#34;data/5.12.1.json\u0026#34; # Path to osquery tables JSON logger: true # Enable remote TLS logger endpoint config: true # Enable remote TLS config endpoint query: true # Enable remote TLS query endpoints carve: true # Enable remote TLS carver endpoints Metrics Configuration Prometheus metrics endpoint settings (TLS service only):\nmetrics: enabled: false # Enable Prometheus metrics listener: \u0026#34;0.0.0.0\u0026#34; port: \u0026#34;9090\u0026#34; Admin UI Configuration Admin service-specific settings:\nadmin: sessionKey: \u0026#34;your-session-key\u0026#34; # Secret key for session cookies staticDir: \u0026#34;/path/to/static\u0026#34; # Static files directory staticOffline: false # Use offline static files templatesDir: \u0026#34;/path/to/templates\u0026#34; backgroundImage: \u0026#34;/path/to/background.svg\u0026#34; brandingImage: \u0026#34;/path/to/brand.png\u0026#34; JWT Configuration JWT authentication settings:\njwt: jwtSecret: \u0026#34;your-jwt-secret\u0026#34; # Secret for signing JWT tokens hoursToExpire: 3 # Token expiration time in hours SAML Configuration SAML authentication settings (Admin service):\nsaml: certPath: \u0026#34;/path/to/saml-cert.pem\u0026#34; keyPath: \u0026#34;/path/to/saml-key.pem\u0026#34; metadataUrl: \u0026#34;https://idp.example.com/metadata\u0026#34; rootUrl: \u0026#34;https://admin.example.com\u0026#34; loginUrl: \u0026#34;https://admin.example.com/login\u0026#34; logoutUrl: \u0026#34;https://admin.example.com/logout\u0026#34; jitProvision: true # Just-in-time user provisioning spInitiated: false # Service Provider initiated flow Osctrld Configuration Settings for osctrld daemon endpoints:\nosctrld: enabled: false # Enable osctrld endpoints Batch Writer Configuration Database batch writer settings for TLS service:\nbatchWriter: writerBatchSize: 50 # Events before flushing writerTimeout: 60s # Max wait time before flush writerBufferSize: 2000 # Event channel buffer size Debug Configuration HTTP request debugging:\ndebug: enableHTTP: false # Enable HTTP request debugging httpFile: \u0026#34;debug-http.log\u0026#34; # File to dump HTTP requests showBody: false # Include request body in dumps Example Configuration Files osctrl-tls (tls.yaml) service: listener: \u0026#34;0.0.0.0\u0026#34; port: \u0026#34;9000\u0026#34; host: \u0026#34;tls.example.com\u0026#34; auth: \u0026#34;none\u0026#34; logLevel: \u0026#34;info\u0026#34; logFormat: \u0026#34;json\u0026#34; db: type: \u0026#34;postgres\u0026#34; host: \u0026#34;127.0.0.1\u0026#34; port: \u0026#34;5432\u0026#34; name: \u0026#34;osctrl\u0026#34; username: \u0026#34;postgres\u0026#34; password: \u0026#34;postgres\u0026#34; sslmode: \u0026#34;disable\u0026#34; maxIdleConns: 20 maxOpenConns: 100 connMaxLifetime: 30 connRetry: 5 redis: host: \u0026#34;127.0.0.1\u0026#34; port: \u0026#34;6379\u0026#34; password: \u0026#34;\u0026#34; db: 0 connRetry: 5 logger: type: \u0026#34;db\u0026#34; loggerDBSame: true alwaysLog: false carver: type: \u0026#34;db\u0026#34; tls: termination: false osquery: version: \u0026#34;5.12.1\u0026#34; tablesFile: \u0026#34;data/5.12.1.json\u0026#34; logger: true config: true query: true carve: true metrics: enabled: true listener: \u0026#34;0.0.0.0\u0026#34; port: \u0026#34;9090\u0026#34; osctrld: enabled: false batchWriter: writerBatchSize: 50 writerTimeout: 60s writerBufferSize: 2000 debug: enableHTTP: false httpFile: \u0026#34;debug-http-tls.log\u0026#34; showBody: false osctrl-admin (admin.yaml) service: listener: \u0026#34;0.0.0.0\u0026#34; port: \u0026#34;9001\u0026#34; host: \u0026#34;admin.example.com\u0026#34; auth: \u0026#34;db\u0026#34; logLevel: \u0026#34;info\u0026#34; logFormat: \u0026#34;json\u0026#34; auditLog: true db: type: \u0026#34;postgres\u0026#34; host: \u0026#34;127.0.0.1\u0026#34; port: \u0026#34;5432\u0026#34; name: \u0026#34;osctrl\u0026#34; username: \u0026#34;postgres\u0026#34; password: \u0026#34;postgres\u0026#34; sslmode: \u0026#34;disable\u0026#34; maxIdleConns: 20 maxOpenConns: 100 connMaxLifetime: 30 connRetry: 5 redis: host: \u0026#34;127.0.0.1\u0026#34; port: \u0026#34;6379\u0026#34; password: \u0026#34;\u0026#34; db: 0 connRetry: 5 logger: type: \u0026#34;db\u0026#34; loggerDBSame: true carver: type: \u0026#34;local\u0026#34; local: carvesDir: \u0026#34;/var/osctrl/carves\u0026#34; tls: termination: false osquery: version: \u0026#34;5.12.1\u0026#34; tablesFile: \u0026#34;data/5.12.1.json\u0026#34; jwt: jwtSecret: \u0026#34;change-this-secret\u0026#34; hoursToExpire: 3 admin: sessionKey: \u0026#34;change-this-session-key\u0026#34; staticDir: \u0026#34;static\u0026#34; staticOffline: false templatesDir: \u0026#34;tmpl_admin\u0026#34; backgroundImage: \u0026#34;static/img/circuit.svg\u0026#34; brandingImage: \u0026#34;static/img/brand.png\u0026#34; debug: enableHTTP: false httpFile: \u0026#34;debug-http-admin.log\u0026#34; showBody: false Command-Line Flags All configuration values can be overridden using command-line flags. Use --help or -h to see all available flags for each service:\n$ ./osctrl-tls --help $ ./osctrl-admin --help $ ./osctrl-api --help Common flags:\n--config or -c: Enable configuration from YAML file --config-file or -C: Path to YAML configuration file --db-host: Database host --db-port: Database port --redis-host: Redis host --listener or -l: Service listener --port or -p: Service port Environment Variables Configuration values can also be set using environment variables. Each flag has a corresponding environment variable (see --help output for details).\nExample:\nexport SERVICE_PORT=\u0026#34;9000\u0026#34; export DB_HOST=\u0026#34;postgres.example.com\u0026#34; export REDIS_HOST=\u0026#34;redis.example.com\u0026#34; Migration from JSON to YAML If you\u0026rsquo;re upgrading from the old JSON-based configuration, you\u0026rsquo;ll need to consolidate your separate JSON files into a single YAML file:\nOld (JSON):\ntls.json - Service settings db.json - Database settings redis.json - Redis settings jwt.json - JWT settings saml.json - SAML settings logger_tls.json - Logger settings carver_tls.json - Carver settings New (YAML):\ntls.yaml - All settings in one file All configuration is now organized into sections within a single YAML file, making it easier to manage and version control your osctrl deployment configuration.\n"
},
{
	"uri": "https://osctrl.net/usage/osctrl-cli/check-db/",
	"title": "check-db",
	"tags": [],
	"description": "",
	"content": "Check DB $ ./osctrl-cli check-db -h NAME: osctrl-cli check-db - Checks DB connection USAGE: osctrl-cli check-db [command options] [arguments...] OPTIONS: --help, -h show help Although this command may appear a bit confusing, it comes in really handy to verify when the backend component is ready to go.\n"
},
{
	"uri": "https://osctrl.net/usage/provision.sh/",
	"title": "provision.sh",
	"tags": [],
	"description": "",
	"content": "provision.sh is the provisioning script for osctrl in Ubuntu 20.04. It uses several functions from lib.sh.\nIts purpose is to install all necessary components to deploy osctrl in an Ubuntu 20.04 system, although it could be easily adapted to work in CentOS 7.\nExecute ./deploy/provision.sh [-h|--help] to show the usage of the script:\n$ ./deploy/provision.sh -h Usage: ./deploy/provision.sh [-h|--help] [PARAMETER [ARGUMENT]] [PARAMETER [ARGUMENT]] ... Parameters: -h, --help Shows this help message and exit. -m MODE, --mode MODE Mode of operation. Default value is dev -t TYPE, --type TYPE Type of certificate to use. Default value is self -p PART, --part PART Part of the service. Default is all Arguments for MODE: dev Provision will run in development mode. Certificate will be self-signed. prod Provision will run in production mode. Arguments for TYPE: self Provision will use a self-signed TLS certificate that will be generated. own Provision will use the TLS certificate provided by the user. certbot Provision will generate a TLS certificate using letsencrypt/certbot. More info here: https://certbot.eff.org/ Arguments for PART: admin Provision will deploy only the admin interface. tls Provision will deploy only the TLS endpoint. api Provision will deploy only the API endpoint. all Provision will deploy both the admin and the TLS endpoint. Optional Parameters: --public-tls-port PORT Port for the TLS endpoint service. Default is 443 --public-admin-port PORT Port for the admin service. Default is 8443 --public-api-port PORT Port for the API service. Default is 8444 --private-tls-port PORT Port for the TLS endpoint service. Default is 9000 --private-admin-port PORT Port for the admin service. Default is 9001 --private-api-port PORT Port for the API service. Default is 9002 --all-hostname HOSTNAME Hostname for all the services. Default is 127.0.0.1 --tls-hostname HOSTNAME Hostname for the TLS endpoint service. Default is 127.0.0.1 --admin-hostname HOSTNAME Hostname for the admin service. Default is 127.0.0.1 --api-hostname HOSTNAME Hostname for the API service. Default is 127.0.0.1 -X PASS --password Force the admin password for the admin interface. Default is random -c PATH --certfile PATH Path to supplied TLS server PEM certificate(s) bundle -d DOMAIN --domain DOMAIN Domain for the TLS certificate to be generated using letsencrypt -e EMAIL --email EMAIL Domain for the TLS certificate to be generated using letsencrypt -s PATH --source PATH Path to code. Default is ~/osctrl -S PATH --dest PATH Path to binaries. Default is /opt/osctrl -n --nginx Install and configure nginx as TLS termination -P --postgres Install and configure PostgreSQL as backend -R --redis Install and configure Redis as cache -E --enroll Enroll the serve into itself using osquery. Default is disabled -N NAME --env NAME Initial environment name to be created. Default is the mode (dev or prod) -U --upgrade Keep osctrl upgraded with the latest code from Github Examples: Provision service in development mode, code is in /code/osctrl and all components (admin, tls, api): ./deploy/provision.sh -m dev -s /code/osctrl -p all Provision service in production mode using my own certificate and only with TLS endpoint: ./deploy/provision.sh -m prod -t own -k /etc/certs/my.key -c /etc/certs/cert.crt -p tls Upgrade service with the latest code from Github. Does not create services nor certificates: ./deploy/provision.sh -U -s /code/osctrl -S /srv/osctrl "
},
{
	"uri": "https://osctrl.net/components/nginx/",
	"title": "nginx",
	"tags": [],
	"description": "",
	"content": " The nginx component performs the task of TLS termination for the osctrl services. If your network has many nodes enrolled in osctrl, most likely your TLS service (osctrl-tls) will receive a large number of requests per second, and on top of TLS termination, this component can then also act as load balancer.\n"
},
{
	"uri": "https://osctrl.net/usage/",
	"title": "Usage",
	"tags": [],
	"description": "",
	"content": "Usage You can\u0026rsquo;t know how to use osctrl components if you don\u0026rsquo;t read the documentation\u0026hellip;\n"
},
{
	"uri": "https://osctrl.net/usage/osctrl-cli/environment/",
	"title": "environment",
	"tags": [],
	"description": "",
	"content": "Environment $ ./osctrl-cli environment -h NAME: osctrl-cli environment - Commands for TLS environment USAGE: osctrl-cli environment command [command options] [arguments...] COMMANDS: add, a Add a new TLS environment update, u Update an existing TLS environment add-scheduled-query Add a new query to the osquery schedule for an environment remove-scheduled-query Remove query from the osquery schedule for an environment add-osquery-option Add or change an osquery option to the configuration remove-osquery-option Remove an option for the osquery configuration add-new-pack Add a new query pack to the osquery configuration add-local-pack Add a new local query pack to the osquery configuration remove-pack Remove query pack from the osquery configuration add-query-to-pack Add a new query to the given query pack remove-query-from-pack Remove query from the given query pack node-actions Node enroll actions for an environment delete, d Delete an existing TLS environment show, s Show a TLS environment list, l List all existing TLS environments help, h Shows a list of commands or help for one command OPTIONS: --help, -h show help Add environment $ ./osctrl-cli environment add -h NAME: osctrl-cli environment add - Add a new TLS environment USAGE: osctrl-cli environment add [command options] [arguments...] OPTIONS: --name value, -n value Environment name to be added --hostname value, --host value Environment host to be added --debug, -d Environment debug capability (default: false) --certificate value, --crt value Certificate file to be read --help, -h show help Update environment $ ./osctrl-cli environment update -h NAME: osctrl-cli environment update - Update an existing TLS environment USAGE: osctrl-cli environment update [command options] [arguments...] OPTIONS: --name value, -n value Environment name to be updated --debug, -d Environment debug capability (default: false) --enroll, -e Environment enroll capability (default: false) --hostname value, --host value Environment host to be updated --logging value, -l value Logging interval in seconds (default: 0) --config value, -c value Config interval in seconds (default: 0) --query value, -q value Query interval in seconds (default: 0) --deb value, --deb-package value DEB package to be updated --rpm value, --rpm-package value RPM package to be updated --msi value, --msi-package value MSI package to be updated --pkg value, --pkg-package value PKG package to be updated --help, -h show help Add scheduled query to environment $ ./osctrl-cli environment add-scheduled-query -h NAME: osctrl-cli environment add-scheduled-query - Add a new query to the osquery schedule for an environment USAGE: osctrl-cli environment add-scheduled-query [command options] [arguments...] OPTIONS: --name value, -n value Environment name to be updated --query value, -q value Query to be added to the schedule --query-name value, -Q value Query name to be idenfified in the schedule --interval value, -i value Query interval in seconds (default: 0) --platform value, -p value Restrict this query to a given platform --version value, -v value Only run on osquery versions greater than or equal-to this version --help, -h show help Remove scheduled query from environment $ ./osctrl-cli environment remove-scheduled-query -h NAME: osctrl-cli environment remove-scheduled-query - Remove query from the osquery schedule for an environment USAGE: osctrl-cli environment remove-scheduled-query [command options] [arguments...] OPTIONS: --name value, -n value Environment name to be updated --query-name value, -q value Query to be removed from the schedule --help, -h show help Add osquery option to environment $ ./osctrl-cli environment add-osquery-option -h NAME: osctrl-cli environment add-osquery-option - Add or change an osquery option to the configuration USAGE: osctrl-cli environment add-osquery-option [command options] [arguments...] OPTIONS: --name value, -n value Environment name to be updated --option value, -o value Option name to be added --type value, -t value Option type for the value (string, int, bool) --string-value value, -s value String value for the option --int-value value, -i value Integer value for the option (default: 0) --bool-value, -b Boolean value for the option (default: false) --help, -h show help Remove osquery option from environment $ ./osctrl-cli environment remove-osquery-option -h NAME: osctrl-cli environment remove-osquery-option - Remove an option for the osquery configuration USAGE: osctrl-cli environment remove-osquery-option [command options] [arguments...] OPTIONS: --name value, -n value Environment name to be updated --option value, -o value Option name to be added --help, -h show help Add query pack to environment $ ./osctrl-cli environment add-new-pack -h NAME: osctrl-cli environment add-new-pack - Add a new query pack to the osquery configuration USAGE: osctrl-cli environment add-new-pack [command options] [arguments...] OPTIONS: --name value, -n value Environment name to be updated --pack value, -p value Pack name to be added --platform value, -P value Restrict this pack to a given platform --version value, -v value Only run on osquery versions greater than or equal-to this version --shard value, -s value Restrict this query to a percentage (1-100) of target hosts (default: 0) --help, -h show help Add local query pack to environment $ ./osctrl-cli environment add-local-pack -h NAME: osctrl-cli environment add-local-pack - Add a new local query pack to the osquery configuration USAGE: osctrl-cli environment add-local-pack [command options] [arguments...] OPTIONS: --name value, -n value Environment name to be updated --pack value, -p value Pack name to be added --pack-path value, -P value Local full path to load the query pack within osquery --help, -h show help Remove query pack from environment $ ./osctrl-cli environment remove-pack -h NAME: osctrl-cli environment remove-pack - Remove query pack from the osquery configuration USAGE: osctrl-cli environment remove-pack [command options] [arguments...] OPTIONS: --name value, -n value Environment name to be updated --pack value, -p value Pack name to be removed --help, -h show help Add query to pack in environment $ ./osctrl-cli environment add-query-to-pack -h NAME: osctrl-cli environment add-query-to-pack - Add a new query to the given query pack USAGE: osctrl-cli environment add-query-to-pack [command options] [arguments...] OPTIONS: --name value, -n value Environment name to be updated --pack value, -p value Environment to be updated --query value, -q value Query to be added to the pack --query-name value, -Q value Query name to be added to the pack --interval value, -i value Query interval in seconds (default: 0) --platform value, -P value Restrict this query to a given platform --version value, -v value Only run on osquery versions greater than or equal-to this version --help, -h show help Remove query from pack in environment $ ./osctrl-cli environment remove-query-from-pack -h NAME: osctrl-cli environment remove-query-from-pack - Remove query from the given query pack USAGE: osctrl-cli environment remove-query-from-pack [command options] [arguments...] OPTIONS: --name value, -n value Environment name to be updated --pack value, -p value Pack name to be updated --query-name value, -q value Query name to be removed --help, -h show help Node actions $ ./osctrl-cli environment node-actions -h NAME: osctrl-cli environment node-actions - Node enroll actions for an environment USAGE: osctrl-cli environment node-actions command [command options] [arguments...] COMMANDS: show-flags, s Show the enroll flags for a TLS environment new-flags, f Generate new enroll flags and save them for a TLS environment gen-flags, F Generate and show the enroll flags for a TLS environment quick-add, q Generates one-liner for quick enrolling nodes to a TLS environment extend-enroll, f Extend the existing enroll URL for a TLS environment rotate-enroll, f Rotate to a new enroll URL for a TLS environment expire-enroll, f Expire the existing enroll URL for a TLS environment notexpire-enroll, f Set the existing enroll URL for a TLS environment to NOT expire quick-remove, Q Generates one-liner for quick removing nodes to a TLS environment extend-remove, f Extend the existing enroll URL for a TLS environment rotate-remove, f Rotate to a new enroll URL for a TLS environment expire-remove, f Expire the existing remove URL for a TLS environment notexpire-remove, f Set the existing remove URL for a TLS environment to NOT expire secret, x Output the secret to enroll nodes in an environment certificate, c, cert Output the certificate to enroll nodes in an environment help, h Shows a list of commands or help for one command OPTIONS: --name value, -n value Environment name to be updated --help, -h show help Show flags $ ./osctrl-cli environment node-actions show-flags -h NAME: osctrl-cli environment node-actions show-flags - Show the enroll flags for a TLS environment USAGE: osctrl-cli environment node-actions show-flags [command options] [arguments...] OPTIONS: --help, -h show help New flags $ ./osctrl-cli environment node-actions new-flags -h NAME: osctrl-cli environment node-actions new-flags - Generate new enroll flags and save them for a TLS environment USAGE: osctrl-cli environment node-actions new-flags [command options] [arguments...] OPTIONS: --help, -h show help Generate flags $ ./osctrl-cli environment node-actions gen-flags -h NAME: osctrl-cli environment node-actions gen-flags - Generate and show the enroll flags for a TLS environment USAGE: osctrl-cli environment node-actions gen-flags [command options] [arguments...] OPTIONS: --certificate value, --crt value Certificate file path to be used --secret value, -s value Secret file path to be used --help, -h show help Quick add $ ./osctrl-cli environment node-actions quick-add -h NAME: osctrl-cli environment node-actions quick-add - Generates one-liner for quick enrolling nodes to a TLS environment USAGE: osctrl-cli environment node-actions quick-add [command options] [arguments...] OPTIONS: --target value, -t value Type of one-liner script (default: \u0026#34;sh\u0026#34;) --insecure, -i Generate insecure one-liner, without HTTPS (default: false) --help, -h show help Extend enroll $ ./osctrl-cli environment node-actions extend-enroll -h NAME: osctrl-cli environment node-actions extend-enroll - Extend the existing enroll URL for a TLS environment USAGE: osctrl-cli environment node-actions extend-enroll [command options] [arguments...] OPTIONS: --help, -h show help Rotate enroll $ ./osctrl-cli environment node-actions rotate-enroll -h NAME: osctrl-cli environment node-actions rotate-enroll - Rotate to a new enroll URL for a TLS environment USAGE: osctrl-cli environment node-actions rotate-enroll [command options] [arguments...] OPTIONS: --help, -h show help Expire enroll $ ./osctrl-cli environment node-actions expire-enroll -h NAME: osctrl-cli environment node-actions expire-enroll - Expire the existing enroll URL for a TLS environment USAGE: osctrl-cli environment node-actions expire-enroll [command options] [arguments...] OPTIONS: --help, -h show help Not expire enroll $ ./osctrl-cli environment node-actions notexpire-enroll -h NAME: osctrl-cli environment node-actions notexpire-enroll - Set the existing enroll URL for a TLS environment to NOT expire USAGE: osctrl-cli environment node-actions notexpire-enroll [command options] [arguments...] OPTIONS: --help, -h show help Quick remove $ ./osctrl-cli environment node-actions quick-remove -h NAME: osctrl-cli environment node-actions quick-remove - Generates one-liner for quick removing nodes to a TLS environment USAGE: osctrl-cli environment node-actions quick-remove [command options] [arguments...] OPTIONS: --target value, -t value Type of one-liner script (default: \u0026#34;sh\u0026#34;) --insecure, -i Generate insecure one-liner, without HTTPS (default: false) --help, -h show help Extend remove $ ./osctrl-cli environment node-actions extend-remove -h NAME: osctrl-cli environment node-actions extend-remove - Extend the existing enroll URL for a TLS environment USAGE: osctrl-cli environment node-actions extend-remove [command options] [arguments...] OPTIONS: --help, -h show help Rotate remove $ ./osctrl-cli environment node-actions rotate-remove -h NAME: osctrl-cli environment node-actions rotate-remove - Rotate to a new enroll URL for a TLS environment USAGE: osctrl-cli environment node-actions rotate-remove [command options] [arguments...] OPTIONS: --help, -h show help Expire remove $ ./osctrl-cli environment node-actions expire-remove -h NAME: osctrl-cli environment node-actions expire-remove - Expire the existing remove URL for a TLS environment USAGE: osctrl-cli environment node-actions expire-remove [command options] [arguments...] OPTIONS: --help, -h show help Not expire remove $ ./osctrl-cli environment node-actions notexpire-remove -h NAME: osctrl-cli environment node-actions notexpire-remove - Set the existing remove URL for a TLS environment to NOT expire USAGE: osctrl-cli environment node-actions notexpire-remove [command options] [arguments...] OPTIONS: --help, -h show help Secret $ ./osctrl-cli environment node-actions secret -h NAME: osctrl-cli environment node-actions secret - Output the secret to enroll nodes in an environment USAGE: osctrl-cli environment node-actions secret [command options] [arguments...] OPTIONS: --help, -h show help Certificate $ ./osctrl-cli environment node-actions certificate -h NAME: osctrl-cli environment node-actions certificate - Output the certificate to enroll nodes in an environment USAGE: osctrl-cli environment node-actions certificate [command options] [arguments...] OPTIONS: --help, -h show help Delete environment $ ./osctrl-cli environment delete -h NAME: osctrl-cli environment delete - Delete an existing TLS environment USAGE: osctrl-cli environment delete [command options] [arguments...] OPTIONS: --name value, -n value Environment name to be deleted --help, -h show help Show environment $ ./osctrl-cli environment show -h NAME: osctrl-cli environment show - Show a TLS environment USAGE: osctrl-cli environment show [command options] [arguments...] OPTIONS: --name value, -n value Environment name to be displayed --help, -h show help List environments $ ./osctrl-cli environment list -h NAME: osctrl-cli environment list - List all existing TLS environments USAGE: osctrl-cli environment list [command options] [arguments...] OPTIONS: --help, -h show help "
},
{
	"uri": "https://osctrl.net/components/backend/",
	"title": "Backend",
	"tags": [],
	"description": "",
	"content": " The backend component provides a centralized place where all the osctrl data is stored. In the diagram above, it is displayed with a PostgreSQL logo, and in fact, the default provisioning of osctrl does install PostgreSQL 9.6 as backend. However, the code that handles database access uses GORM so the changes to make osctrl work with a different backend solution would be minimal.\nEach component uses the backend differently but all of them have read/write operations.\n"
},
{
	"uri": "https://osctrl.net/contributing/",
	"title": "Contributing",
	"tags": [],
	"description": "",
	"content": "Like any other open source projects, there are multiple ways to contribute to osctrl:\nAs a developer, depending on your skills and experience, As a user who enjoys the project and wants to help. Reporting Bugs If you found something broken or not working properly, feel free to create an issue in Github with as much information as possible, such as logs and how to reproduce the problem. Before opening the issue, make sure that:\nYou have read this documentation, You are using the latest stable version of osctrl, You already searched other issues to see if your problem or request was already reported. Improving the Documentation You can improve this documentation by forking its repository, updating the content and sending a pull request.\nWe  Pull Requests A pull request does not need to be a fix for a bug or implementing something new. Software can always be improved, legacy code removed and tests are always welcome!\nPlease do not be afraid of contributing code, make sure it follows these rules:\nYour code compiles, does not break any of the existing code in the master branch and does not cause conflicts, The code is readable and has comments, that aren\u0026rsquo;t superfluous or unnecessary, An overview or context is provided as body of the Pull Request. It does not need to be too extensive. Extra points if your code comes with tests!\n"
},
{
	"uri": "https://osctrl.net/usage/osctrl-cli/login/",
	"title": "login",
	"tags": [],
	"description": "",
	"content": "Login $ ./osctrl-cli login -h NAME: osctrl-cli login - Login into API and generate JSON config file with token USAGE: osctrl-cli login [command options] [arguments...] OPTIONS: --username value, -u value User to be used in login --environment value, -e value Environment to be used in login --write-api-file, -w Write API configuration to JSON file (default: false) --help, -h show help "
},
{
	"uri": "https://osctrl.net/components/metrics/",
	"title": "Metrics",
	"tags": [],
	"description": "",
	"content": " The metrics component of osctrl provides instrumentation for the following operations:\nReceiving requests to osctrl-tls, Receiving requests to osctrl-admin, Generating errors during normal operations both in osctrl-tls and osctrl-admin. Note that if the number of enrolled nodes is large enough, these metrics will generate valuable data to assess the performance of osctrl.\nThe default provisioning of osctrl does install InfluxDB + Telegraf + Grafana to act as the metrics component, but any monitoring solution that follows the push model, should work as well.\n"
},
{
	"uri": "https://osctrl.net/components/osctrld/",
	"title": "osctrld",
	"tags": [],
	"description": "",
	"content": " The osctrld component is the CLI for osctrl. Its purpose is to execute actions in osctrl without having to access directly the backend or use the admin interface. It can be very handy to automate actions in scripts or similar.\nFor a comprehensive list of all the commands and options, take a look at the usage of osctrld.\n"
},
{
	"uri": "https://osctrl.net/usage/osctrl-cli/node/",
	"title": "node",
	"tags": [],
	"description": "",
	"content": "Node $ ./bin/osctrl-cli node -h NAME: osctrl-cli node - Commands for nodes USAGE: osctrl-cli node [command options] COMMANDS: delete, d Delete and archive an existing node tag, t Tag an existing node list, l List enrolled nodes show, s Show an existing node lookup, f Lookup existing nodes by identifier (UUID, hostname or localname) help, h Shows a list of commands or help for one command OPTIONS: --help, -h Show help (default: false) Delete node $ ./bin/osctrl-cli node delete -h NAME: osctrl-cli node delete - Delete and archive an existing node USAGE: osctrl-cli node delete [command options] OPTIONS: --uuid value, -u value Node UUID to be deleted --env value, -e value Environment to be used --help, -h Show help (default: false) Tag node $ ./bin/osctrl-cli node tag -h NAME: osctrl-cli node tag - Tag an existing node USAGE: osctrl-cli node tag [command options] OPTIONS: --uuid value, -u value Node UUID to be tagged --env value, -e value Environment to be used --name value, -n value, --tag-value value Tag name to be used. It will be created if does not exist --tag-type value, --type value Tag type to be used. It can be \u0026#39;env\u0026#39;, \u0026#39;uuid\u0026#39;, \u0026#39;localname\u0026#39; and \u0026#39;custom\u0026#39; (default: \u0026#34;custom\u0026#34;) --help, -h Show help (default: false) List nodes $ ./bin/osctrl-cli node list -h NAME: osctrl-cli node list - List enrolled nodes USAGE: osctrl-cli node list [command options] OPTIONS: --active, -a Show active nodes (default: true) --all, -A Show all nodes (default: false) --inactive, -i Show inactive nodes (default: false) --env value, -e value Environment to be used --help, -h Show help (default: false) Show node $ ./bin/osctrl-cli node show -h NAME: osctrl-cli node show - Show an existing node USAGE: osctrl-cli node show [command options] OPTIONS: --uuid value, -u value Node UUID to be shown --env value, -e value Environment to be used --help, -h Show help (default: false) Lookup node $ ./bin/osctrl-cli node lookup -h NAME: osctrl-cli node lookup - Lookup existing nodes by identifier (UUID, hostname or localname) USAGE: osctrl-cli node lookup [command options] OPTIONS: --identifier value, --id value, -i value Node identifier to be looked up (UUID, hostname or localname) --help, -h Show help (default: false) "
},
{
	"uri": "https://osctrl.net/usage/osctrl-cli/query/",
	"title": "query",
	"tags": [],
	"description": "",
	"content": "Query $ ./bin/osctrl-cli query -h NAME: osctrl-cli query - Commands for queries USAGE: osctrl-cli query [command options] COMMANDS: complete, c Mark an on-demand query as completed delete, d Mark an on-demand query as deleted expire, e Mark an on-demand query as expired run, r Start a new on-demand query list, l List on-demand queries help, h Shows a list of commands or help for one command OPTIONS: --help, -h Show help (default: false) Complete query $ ./osctrl-cli query complete -h NAME: osctrl-cli query complete - Mark an on-demand query as completed USAGE: osctrl-cli query complete [command options] [arguments...] OPTIONS: --name value, -n value Query name to be completed --env value, -e value Environment to be used --help, -h show help Delete query $ ./osctrl-cli query delete -h NAME: osctrl-cli query delete - Mark an on-demand query as deleted USAGE: osctrl-cli query delete [command options] [arguments...] OPTIONS: --name value, -n value Query name to be deleted --env value, -e value Environment to be used --help, -h show help Expire query $ ./osctrl-cli query expire -h NAME: osctrl-cli query expire - Mark an on-demand query as expired USAGE: osctrl-cli query expire [command options] [arguments...] OPTIONS: --name value, -n value Query name to be expired --env value, -e value Environment to be used --help, -h show help Run query $ ./osctrl-cli query run -h NAME: osctrl-cli query run - Start a new on-demand query USAGE: osctrl-cli query run [command options] [arguments...] OPTIONS: --query value, -q value Query to be issued --env value, -e value Environment to be used --uuid value, -u value Node UUID to be used --hidden, -x Mark query as hidden (default: false) --expiration value, -E value Expiration in hours (0 for no expiration) (default: 6) --help, -h show help List queries $ ./osctrl-cli query list -h NAME: osctrl-cli query list - List on-demand queries USAGE: osctrl-cli query list [command options] [arguments...] OPTIONS: --all, -A Show all queries (default: false) --active, -a Show active queries (default: false) --completed, -c Show completed queries (default: false) --deleted, -d Show deleted queries (default: false) --hidden, -x Show hidden queries (default: false) --expired, -E Show expired queries (default: false) --env value, -e value Environment to be used --help, -h show help "
},
{
	"uri": "https://osctrl.net/usage/osctrl-cli/settings/",
	"title": "settings",
	"tags": [],
	"description": "",
	"content": "Settings $ ./osctrl-cli settings -h NAME: osctrl-cli settings - Commands for settings USAGE: osctrl-cli settings command [command options] [arguments...] COMMANDS: add, a Add a new settings value update, u Update a configuration value delete, d Delete an existing configuration value show, s Show all configuration values help, h Shows a list of commands or help for one command OPTIONS: --help, -h show help Add setting $ ./osctrl-cli settings add -h NAME: osctrl-cli settings add - Add a new settings value USAGE: osctrl-cli settings add [command options] [arguments...] OPTIONS: --name value, -n value Value name to be added --service value, -s value Value service to be added --type value, -t value Value type to be added --string value Value string --integer value Value integer (default: 0) --boolean Value boolean (default: false) --info value, -i value Setting info --help, -h show help Update setting $ ./osctrl-cli settings update -h NAME: osctrl-cli settings update - Update a configuration value USAGE: osctrl-cli settings update [command options] [arguments...] OPTIONS: --name value, -n value Value name to be updated --service value, -s value Value service to be updated --type value, -t value Value type to be updated --string value Value string --integer value Value integer (default: 0) --true Value boolean true (default: false) --false Value boolean false (default: false) --info value, -i value Setting info --help, -h show help Delete setting $ ./osctrl-cli settings delete -h NAME: osctrl-cli settings delete - Delete an existing configuration value USAGE: osctrl-cli settings delete [command options] [arguments...] OPTIONS: --name value, -n value Value name to be deleted --service value, -s value Value service to be deleted --help, -h show help Show settings $ ./osctrl-cli settings show -h NAME: osctrl-cli settings show - Show all configuration values USAGE: osctrl-cli settings show [command options] [arguments...] OPTIONS: --help, -h show help "
},
{
	"uri": "https://osctrl.net/usage/osctrl-cli/tag/",
	"title": "tag",
	"tags": [],
	"description": "",
	"content": "Tags $ ./osctrl-cli tag -h NAME: osctrl-cli tag - Commands for tags USAGE: osctrl-cli tag command [command options] [arguments...] COMMANDS: add, a Add a new tag edit, e Edit values for an existing tag delete, d Delete an existing tag list, l List all tags by environment list-all, L List all tags in osctrl show, s Show an existing tag help, h Shows a list of commands or help for one command OPTIONS: --help, -h show help Add tag $ ./osctrl-cli tag add -h NAME: osctrl-cli tag add - Add a new tag USAGE: osctrl-cli tag add [command options] [arguments...] OPTIONS: --name value, -n value Tage name to be used --env-uuid value, -e value Environment UUID to be used --icon value, -i value Fontawesome icon to be used (default: \u0026#34;fas fa-tag\u0026#34;) --color value, -c value HTML color to be used. If not provided it will be randomly generated --description value, -d value Tag description to be used --tag-type value, -t value, --type value Tag type to be used. It can be \u0026#39;env\u0026#39;, \u0026#39;uuid\u0026#39;, \u0026#39;platform\u0026#39;, \u0026#39;localname\u0026#39; and \u0026#39;custom\u0026#39; (default: \u0026#34;custom\u0026#34;) --help, -h show help Edit tag $ ./osctrl-cli tag edit -h NAME: osctrl-cli tag edit - Edit values for an existing tag USAGE: osctrl-cli tag edit [command options] [arguments...] OPTIONS: --name value, -n value Tage name to be used --env-uuid value, -e value Environment UUID to be used --icon value, -i value Fontawesome icon to be used --color value, -c value HTML color to be used. If not provided it will be randomly generated --description value, -d value Tag description to be used --tag-type value, -t value, --type value Tag type to be used. It can be \u0026#39;env\u0026#39;, \u0026#39;uuid\u0026#39;, \u0026#39;platform\u0026#39;, \u0026#39;localname\u0026#39; and \u0026#39;custom\u0026#39; --help, -h show help Delete tag $ ./osctrl-cli tag delete -h NAME: osctrl-cli tag delete - Delete an existing tag USAGE: osctrl-cli tag delete [command options] [arguments...] OPTIONS: --name value, -n value Tag name to be deleted --env-uuid value, -e value Environment UUID to be used --help, -h show help List tags $ ./osctrl-cli tag list -h NAME: osctrl-cli tag list - List all tags by environment USAGE: osctrl-cli tag list [command options] [arguments...] OPTIONS: --env-uuid value, -e value Environment UUID to be used --help, -h show help List all tags $ ./osctrl-cli tag list-all -h NAME: osctrl-cli tag list-all - List all tags in osctrl USAGE: osctrl-cli tag list-all [command options] [arguments...] OPTIONS: --help, -h show help Show tag $ ./osctrl-cli tag show -h NAME: osctrl-cli tag show - Show an existing tag USAGE: osctrl-cli tag show [command options] [arguments...] OPTIONS: --name value, -n value Tag name to be displayed --env-uuid value, -e value Environment UUID to be used --help, -h show help "
},
{
	"uri": "https://osctrl.net/usage/osctrl-cli/user/",
	"title": "user",
	"tags": [],
	"description": "",
	"content": "User $ ./bin/osctrl-cli user -h NAME: osctrl-cli user - Commands for users USAGE: osctrl-cli user [command options] COMMANDS: add, a Add a new user edit, e Edit an existing user change-permissions, p, access Change permission in an environment for an existing user reset-permissions, R, reset Clear and reset permissions for a user in an environment show-permissions, S, perms Show permissions for a user in an environment all-permissions, A, all-perms Show all permissions for an existing user delete, d Delete an existing user show, s Show an existing user list, l List all existing users help, h Shows a list of commands or help for one command OPTIONS: --help, -h Show help (default: false) Add user $ ./bin/osctrl-cli user add -h NAME: osctrl-cli user add - Add a new user USAGE: osctrl-cli user add [command options] OPTIONS: --username value, -u value Username for the new user --password value, -p value Password for the new user --global-admin, -a, --admin Make this user a global admin (default: false) --service, -s Make this user a service account (default: false) --environment value, -e value Grant read access to this environment --email value, -E value Email for the new user --fullname value, -n value Full name for the new user --help, -h Show help (default: false) Edit user $ ./bin/osctrl-cli user edit -h NAME: osctrl-cli user edit - Edit an existing user USAGE: osctrl-cli user edit [command options] OPTIONS: --username value, -u value User to be edited --password value, -p value New password to be used --email value, -E value Email to be used --fullname value, -n value Full name to be used --global-admin, -a, --admin Make this user an admin (default: false) --non-admin, -d Make this user an non-admin (default: false) --service, -s Make this user a service account (default: false) --non-service, -S Make this user a non-service account (default: false) --environment value, --env value Grant read access to this environment --help, -h Show help (default: false) Change permissions $ ./bin/osctrl-cli user change-permissions -h NAME: osctrl-cli user change-permissions - Change permission in an environment for an existing user USAGE: osctrl-cli user change-permissions [command options] OPTIONS: --username value, -u value User to perform the action --environment value, -e value Environment for this user --admin, -a Grant admin permissions (default: false) --user, -U Grant user permissions (default: false) --query, -q Grant query permissions (default: false) --carve, -c Grant carve permissions (default: false) --help, -h Show help (default: false) Reset permissions $ ./bin/osctrl-cli user reset-permissions -h NAME: osctrl-cli user reset-permissions - Clear and reset permissions for a user in an environment USAGE: osctrl-cli user reset-permissions [command options] OPTIONS: --username value, -u value User to perform the action --environment value, -e value Environment for this user --admin, -a Grant admin permissions (default: false) --user, -U Grant user permissions (default: false) --query, -q Grant query permissions (default: false) --carve, -c Grant carve permissions (default: false) --help, -h Show help (default: false) Show permissions $ ./bin/osctrl-cli user show-permissions -h NAME: osctrl-cli user show-permissions - Show permissions for a user in an environment USAGE: osctrl-cli user show-permissions [command options] OPTIONS: --username value, -u value User to perform the action --environment value, -e value Environment for this user --help, -h Show help (default: false) All permissions $ ./bin/osctrl-cli user all-permissions -h NAME: osctrl-cli user all-permissions - Show all permissions for an existing user USAGE: osctrl-cli user all-permissions [command options] OPTIONS: --username value, -u value User to perform the action --help, -h Show help (default: false) Delete user $ ./bin/osctrl-cli user delete -h NAME: osctrl-cli user delete - Delete an existing user USAGE: osctrl-cli user delete [command options] OPTIONS: --username value, -u value User to be deleted --help, -h Show help (default: false) Show user $ ./bin/osctrl-cli user show -h NAME: osctrl-cli user show - Show an existing user USAGE: osctrl-cli user show [command options] OPTIONS: --username value, -u value User to be displayed --help, -h Show help (default: false) List users $ ./bin/osctrl-cli user list -h NAME: osctrl-cli user list - List all existing users USAGE: osctrl-cli user list [command options] OPTIONS: --help, -h Show help (default: false) "
},
{
	"uri": "https://osctrl.net/",
	"title": "",
	"tags": [],
	"description": "",
	"content": "osctrl What is osctrl? osctrl is a fast and efficient osquery management solution, implementing its remote API as TLS endpoint.\nWith osctrl you are able to:\nMonitor all your systems running osquery, Distribute osquery configuration fast across all your enrolled nodes, Collect all the status and result logs, whether you want to store them or forward them to a different system (Splunk, ELK, Kafka, Graylog\u0026hellip;), Run quasi-real-time on-demand queries in your selected enrolled nodes, Carve files or directories from your enrolled nodes. osctrl has been designed to work as a scalable and reliable solution. It has been used successfully in networks from hundreds to hundreds of thousands nodes.\nGive it a try!\nhttps://github.com/jmpsec/osctrl\n"
},
{
	"uri": "https://osctrl.net/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "https://osctrl.net/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
}]